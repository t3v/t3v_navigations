<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers"
      data-namespace-typo3-fluid="true">
  <v:variable.set name="contentObject" value="t3v-navigations-vendor-navigation" />

  <v:tag name="nav" class="{contentObject} navigation content-object" data="{type: settings.type, layout: settings.layout}"
         hideIfEmpty="true">
    <v:tag name="ul" class="{contentObject}__entries navigation__entries" hideIfEmpty="true">
      <f:render section="Entries" arguments="{_all}" />
    </v:tag>
  </v:tag>

  <f:section name="Entries">
    <f:if condition="{settings.items}">
      <f:for each="{settings.items}" as="item" iteration="i">
        <f:if condition="{item.page}">
          <f:render section="PageEntry" arguments="{_all}" />
        </f:if>

        <f:if condition="{item.link}">
          <f:render section="LinkEntry" arguments="{_all}" />
        </f:if>

        <f:if condition="{i.isLast}">
          <f:else>
            <f:render section="Divider" arguments="{_all}" />
          </f:else>
        </f:if>
      </f:for>
    </f:if>
  </f:section>

  <f:section name="PageEntry">
    <v:variable.set name="layout" value="{v:format.replace(content: item.layout, substring: ',', replacement: ' ')}" />

    <f:if condition="{v:page.info(field: 'uid')} == {item.page}">
      <f:then>
        <v:tag name="li" class="{contentObject}__entry navigation__entry" data="{state: 'active'}" hideIfEmpty="true">
          <f:link.page pageUid="{item.page}" class="{contentObject}__item navigation__item" title="{item.title}"
                       data="{type: item.type, layout: layout}">
            {item.name}
          </f:link.page>
        </v:tag>
      </f:then>

      <f:else>
        <v:tag name="li" class="{contentObject}__entry navigation__entry" hideIfEmpty="true">
          <f:link.page pageUid="{item.page}" class="{contentObject}__item navigation__item" title="{item.title}"
                       data="{type: item.type, layout: layout}">
            {item.name}
          </f:link.page>
        </v:tag>
      </f:else>
    </f:if>
  </f:section>

  <f:section name="LinkEntry">
    <v:variable.set name="layout" value="{v:format.replace(content: item.layout, substring: ',', replacement: ' ')}" />

    <v:tag name="li" class="{contentObject}__entry navigation__entry" hideIfEmpty="true">
      <v:condition.string.contains haystack="{item.link}" needle="blank">
        <f:then>
          <f:link.typolink parameter="{item.link}" class="{contentObject}__item navigation__item" title="{item.title}"
                           additionalAttributes="{rel: 'noopener', data-type: item.type, data-layout: layout}">
            {item.name}
          </f:link.typolink>
        </f:then>

        <f:else>
          <f:link.typolink parameter="{item.link}" class="{contentObject}__item navigation__item" title="{item.title}"
                           additionalAttributes="{data-type: item.type, data-layout: layout}">
            {item.name}
          </f:link.typolink>
        </f:else>
      </v:condition.string.contains>
    </v:tag>
  </f:section>

  <f:section name="Divider">
    <f:if condition="{settings.divider}">
      <li class="{contentObject}__divider navigation__divider">
        <f:switch expression="{settings.divider}">
           <f:case value="pipe">|</f:case>
           <f:case value="hyphen">-</f:case>
           <f:defaultCase>|</f:defaultCase>
        </f:switch>
      </li>
    </f:if>
  </f:section>
</html>
